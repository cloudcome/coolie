/*!
 * coolie 苦力
 * @author ydr.me
 * @version 0.3.0
 * @license MIT
 */
!function(){"use strict";function e(e,o){var a,u,l,d={};2===arguments.length?(l=e,d._isAnonymous=!1,d._id=o,d._type="ajax",d._path=s(o),d._deps=[],d._factory=function(e,n,t){t.exports=l.responseText||"",l=null},n(d),H[d._id]=d,G[d._id]={}):U.length&&(u=e,a=U.shift(),d._isAnonymous=""===a[0],d._id=a[0]||u.id,d._type=a[0]?"local":"script",u=null,d._path=d._isAnonymous?s(d._id):"",d._deps=a[1],d._factory=a[2],n(d),H[d._id]=d,G[d._id]={},d._deps.length&&m(d._deps,function(e,n){var t=n.replace(T,""),o=d._isAnonymous?c(d._path,t):t;if(G[o]&&G[o][d._id])throw"module `"+d._id+"` and module `"+o+"` make up a circular dependency relationship";d._deps[e]=o,G[d._id][o]=1,X.push({id:o,by:d._id}),G[o]||(G[o]={},T.test(n)?i(o):r(o))})),I===P&&!U.length&&v&&H[v]&&(m(X,function(e,n){if(!G[n.id])throw"can not found module `"+n.id+"`, but module `"+n.by+"` dependence on it"}),t(v),G=null,U=null,X=null)}function n(e){e.exports={},e._exec=function(){var n=function(n){n=n.replace(T,"");var t=e._isAnonymous?o(c(s(e._id),n)):n;if(!H[t])throw"can not found module `"+t+"`, require in `"+e._id+"`";return H[t]._exec()};return function(){var t=e._id;return e._hasExport?H[t].exports:(e._factory.call(window,n,e.exports,e),e._hasExport=!0,H[t].exports=e.exports)}}()}function t(e){if(!H[e])throw"can not found module `"+e+"`";console.log("past "+(Date.now()-y)+" ms"),console.groupEnd("coolie modules"),H[e]._exec(),f(coolie.callback)&&coolie.callback(H[e].exports)}function o(e){if(e.indexOf("?")>-1)return e;var n=e.slice(-1);switch(n){case"#":return e.slice(0,-1);case"/":return e+"index.js";default:return S.test(e)?e:e+".js"}}function r(n){n=o(n);var t,r,i=a(n),s=Date.now(),c=h(n);return I++,i?(t=document.createElement("script"),r=function(n){M.removeChild(t),"error"===n.type?console.groupEnd("coolie modules"):(console.log("script module",c,Date.now()-s+"ms"),P++,e(t))},t.id=n,t.async=!0,t.defer=!0,t.src=c,t.onload=t.onerror=r,void M.appendChild(t)):setTimeout(function(){console.log("local module",c,Date.now()-s+"ms"),P++,e()},1)}function i(n){I++;var t=new XMLHttpRequest,o=Date.now(),r=function(){if(200!==t.status&&304!==t.status)throw"can not ajax "+n+", response status is "+t.status;console.log("text module",n,Date.now()-o+"ms"),P++,e(t,n)};t.onload=t.onerror=t.onabort=t.ontimeout=r,t.open("GET",n),t.send(null)}function s(e){return e.replace(D,"/")}function a(e){return(e.replace(T,"").replace(O,"").match($)||[""])[0]}function c(e,n){var t=(e.match(O)||[""])[0],o=a(e),r=a(n),i=0,s=e.replace(O,""),c=n;switch(o||(s="./"+s),"/"!==s.slice(-1)&&(s+="/"),r||(c="./"+c,r="./"),r){case"./":return t+s+c.slice(2);case"../":for(i=c.match(A).length;i-->0;){if(!k.test(s))throw"can not change path from `"+e+"` to `"+n+"`";s=s.replace(k,"")}return t+s+c.replace(A,"");default:return t+c}}function u(e){var n=[];return e.replace(j,"").replace(E,function(e,t,o){o&&n.push(o)}),n}function l(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function d(e){return"array"===l(e)}function f(e){return"function"===l(e)}function p(e){return"string"===l(e)}function m(e,n){var t,o;if(d(e))for(t=0,o=e.length;o>t&&n(t,e[t])!==!1;t++);else if("object"==typeof e)for(t in e)if(e.hasOwnProperty(t)&&n(t,e[t])===!1)break}function h(e){var n,t,o,r=l(B.version);switch(r){case"string":return e+(e.indexOf("?")>-1?"&":"?")+"_="+encodeURIComponent(B.version);case"object":return n=e.replace(B.base,""),o=(e.match(q)||[""])[0],t=B.version[n]||B.version["./"+n],t?e.replace(q,"").replace(C,"."+t+"$1")+o:e;default:return e}}function w(){var e=document.getElementsByTagName("script");return e[e.length-1]}function _(e){return e.dataset?e.dataset.main:e.getAttribute("data-main")}var g,b,v,y,x="0.3.0",E=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,j=/\\\\/g,A=/\.\.\//g,D=/\/([^\/]+)$/,$=/^.*?\//,k=/[^\/]+\/$/,q=/\?.*$/,C=/(\.[^.]*)$/,O=/^.*\/\/[^\/]*/,T=/^(css|html|text)!/i,S=/\.js$/i,L=w(),M=L.parentNode,N=location.protocol+"//"+location.host+s(c(s(location.pathname),L.getAttribute("src"))),R=_(L),B={base:N},G={},H={},I=0,P=0,U=[],X=[];window.define=function(e,n,t){var o=arguments,r=1===o.length;if(v||(r?v=g:(b=v=e,G={},G[b]={})),r)t=o[0],e="";else{if(!p(e))throw new Error("module id must be a string");if(f(o[1])&&(t=o[1],n=[]),!d(n))throw new Error("module defineModules must be an array")}if(!f(t))throw new Error("module factory must be a function");n=r?u(t.toString()):n,U.push([e,n,t])},window.coolie={version:x,modules:H,callback:null,config:function(e){return e=e||{},B.base=e.base?c(N,e.base):N,B.version=e.version,this},use:function(e){if(g)throw new Error("can not  execute `coolie.use` twice more");if(!p(B.base))throw new Error("coolie config `base` property must be a string");if(e&&!p(e))throw new Error("main module must be a string");return R&&R!==e&&(e&&console.warn("attribute main is `"+R+"`, but use main is `"+e+"`"),e=R),g=c(B.base,e),y=Date.now(),console.group("coolie modules"),r(g),this}}}();