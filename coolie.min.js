/*!
 * coolie 苦力
 * @author ydr.me
 * @version 0.13.1
 * @license MIT
 */
(function(){"use strict";var e=this;if(!e.coolie||!e.coolie.done){var t="0.13.1",n={};n.version=t;var r,o=function(){return(new Date).getTime()},i=0,u=e.document,c={},a=[],s=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},l=function(e){return"array"===s(e)},f=function(e){return"function"===s(e)},d=function(e){return"string"===s(e)},p=function(e,t,n){var r,o;if(l(e))for(r=n?e.length-1:0,o=n?0:e.length;(n?r>o:o>r)&&t(r,e[r])!==!1;n?r--:r++);else if("object"==typeof e)for(r in e)if(t(r,e[r])===!1)break},h=function(){var t={},n=e.console,r=["log","warn","group","groupEnd"];return p(r,function(e,r){t[r]=function(){if(c.debug&&n&&n[r])try{n[r].apply(n,arguments)}catch(e){}}}),t}(),v=/\/[^/]+$/,g=/^((ftp|file|https?):)?\/\/[^\/]*/,m=/^\/\//,_=function(e,t){return e=e.replace(g,""),"/"===e?e:v.test(e)?t?e+"/":e.replace(v,"/"):e},y=/^\/|((http|ftp)s?:\/\/)/,x=/^(\.{1,2})\//,b=/(\/[^/]+?)?\/$/,j=function(e,t){if(!t||y.test(t))return t;var n;for(t="./"+t;n=t.match(x);)t=t.replace(x,""),2===n[1].length&&(e=e.replace(b,"/"));return e+t},w=function(e,t){return(t||u).getElementsByTagName(e)},A=/[\?#].*?$/,S=/\.js($|\?)/i,E=function(e,t){return e=e.replace(A,""),t?e:(b.test(e)&&(e+="index"),e+(S.test(e)?"":".js"))},$=function(e){return E(e.hasAttribute?e.src:e.getAttribute("src",4))},q=function(e,t){return e.getAttribute("data-"+t)},C=/loaded|complete/,L=u.head||w("head",u)[0],k=/\.[^.]*$/,T=function(e){if(!c._v)return e;var t=d(c._v)?c._v:c._v[e];return t?e.replace(k,"."+t+"$&"):e},D=null,J=function(t,n){var o=T(t),i=u.createElement("script"),c=!1,a=function(e){if(!c){if(c=!0,e&&"error"===e.type)throw"load script error\n"+o;n!==!0&&(D=i,st(i)),L.removeChild(i),i=null}};i.src=o,i.id=t,i.async=!0,i.defer=!0,i.onload!==r?i.onload=i.onerror=a:i.onreadystatechange=function(t){C.test(i.readyState)&&(t=t||e.event,a(t))},L.appendChild(i)},R=function(e,t){var n={};try{n=JSON.parse(t)}catch(r){try{var o=new Function("","return "+t);n=o()}catch(i){throw"parse json error "+e}}return n},U=function(e,t){var n,r=T(e),o=new XMLHttpRequest,i=function(){if(4===o.readyState&&!n){if(n=!0,200!==o.status&&304!==o.status)throw"ajax error\n"+r;lt({_isAn:W._isAn,id:e,url:r,deps:[],factory:function(){var n=o.responseText;return n&&"json"===t&&(n=R(e,n)),n}})}};o.onload=o.onreadystatechange=o.onerror=o.onabort=o.ontimeout=i,o.open("GET",r),o.send(null)},B=function(e){lt({_isAn:W._isAn,id:e,url:T(e),deps:[],factory:function(){return e}})},G=function(){var e=w("script");return e[e.length-1]},H=G(),M=function(e){return m.test(e)&&(e=location.protocol+e),(e.match(g)||[])[0]},N=n.coolieJSURL=$(H),O=M(N),P=q(H,"config"),F=q(H,"main"),X=_(N),z=P?j(X,P):null,I=P?_(z):null,K=P?j(O,z):null,Q=function(){if(!P)return null;var e=M(K);return e?e:(e=O,K=e+K,e)}(),V=I,W={},Y=!1,Z={},et=[],tt={},nt=1,rt=0;n.config=function(t){if(c=t,c.version=c.version||{},K?V=j(I,_(c.base,!0)):(Q=M(t.base),V=_(t.base)),d(c.version)?c._v=c.version:(c._v={},p(c.version,function(e,t){c._v[Q+j(V,e)]=t})),F){var r=W.url=E(Q+j(V,F));W._dfn=!1,Z[r]=W}return e.DEBUG=t.debug=t.debug!==!1,n},n.use=function(e){return Y?n:(Y=!0,i=o(),e&&(W.url=Q+j(V,e),Z[W.url]=W),W.url?(J(W.url),h.group("coolie modules"),n):n)},n.callback=function(e){return W._executed&&f(e)?(e.call(n,W.exports),n):(f(e)&&a.push(e),n)};var ot=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,it=/\\\\/g,ut=/([^"']+)(?:['"]\s*?,\s*?['"]([^'"]*))?/,ct={image:"image",text:"text",html:"text",json:"json",css:"text"},at=function(e){var t=[];return e.replace(it,"").replace(ot,function(e,n,r){if(r){var o=r.match(ut),i={name:E(o[1],!!o[2]),type:o[2]?ct[o[2].toLowerCase()]:"js"};t.push(i)}}),t},st=function(e){var t=!0,n=et.shift();if(!n)throw"can not parse module "+(D?D.src:"undefined");var r=n[0],o=n[1],i=n[2],u=e.id,c=$(e),a=_(u);f(n[2])?t=!1:f(n[1])?(r=null,o=[],i=n[1]):f(n[0])&&(i=n[0],o=at(i.toString()),r=null),r=W._dfn&&W._isAn?u:r||u;var s={_isAn:t,_path:a,_node:e,id:r,url:c,deps:o,factory:i};W.id||(t||(Z[r]=Z[W.url]),s._isMain=!0,W=s,W._dfn=!0);var l=[];p(o,function(e,t){if(d(t)&&(t={id:t}),W._isAn){var n=j(a,t.name);t.id=E(Q+n,"js"!==t.type)}if(r===t.id)throw"required myself: \n"+r;if(tt[t.id]&&p(tt[t.id].deps,function(e,t){if(t===r)throw"required circle: \n"+t+"\n"+r}),!Z[t.id]&&(l.push(t.id),Z[t.id]=!0,nt++,W._isAn))switch(t.type){case"text":case"json":U(t.id,t.type);break;case"image":B(t.id);break;default:J(t.id)}}),s.deps=l,lt(s),et.length&&st(D)},lt=function(t){t.exports={},t._execute=function(){var n=function(e,n){var r;if(W._isAn&&(r={name:e,type:n||"js"},e=Q+E(j(t._path,r.name),"js"!==r.type)),!tt[e])throw"can not found module \n"+e+"\nbut required in\n"+t.id;return tt[e]._execute()};return function(){var r=t.id;return t._executed?tt[r].exports:(t._executed=!0,tt[r].exports=t.factory.call(e,n,t.exports,t)||t.exports,tt[r].exports)}}(),tt[t.id]=t,rt++,h.log("module "+t.id),et.length||rt!==nt||(h.log("past "+(o()-i)+"ms"),h.groupEnd("coolie modules"),W._execute(),p(a,function(e,t){t.call(n,W.exports)}))},ft=function(e,t,n){et.push([e,t,n])};P&&J(K,!0),e.coolie=n,e.coolie.modules=tt,e.coolie.each=p,e.coolie.getHost=M,e.coolie.getPathJoin=j,e.coolie.getPathDir=_,e.coolie.getCurrentScript=G,e.coolie.getScriptURL=$,e.coolie.done=!0,e.coolie.script=H;var dt=u.createElement("div");dt.appendChild(H),e.define=ft,e.define.amd={},e.define.cmd={}}}).call(this);