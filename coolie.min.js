/*!
 * coolie 苦力
 * @author ydr.me
 * @version 0.2.0
 * @license MIT
 */
!function(){"use strict";function e(e,a){var c,u,l,d={};2===arguments.length?(l=e,d._isAnonymous=!1,d._id=a,d._type="ajax",d._path=i(a),d._deps=[],d._factory=function(e,n,o){o.exports=l.responseText||"",l=null},n(d),B[d._id]=d,R[d._id]={}):I.length&&(u=e,c=I.shift(),d._isAnonymous=""===c[0],d._id=c[0]||u.id,d._type=c[0]?"local":"script",u=null,d._path=d._isAnonymous?i(d._id):"",d._deps=c[1],d._factory=c[2],n(d),B[d._id]=d,R[d._id]={},d._deps.length&&p(d._deps,function(e,n){var o=n.replace(T,""),i=d._isAnonymous?s(d._path,o):o;if(R[i]&&R[i][d._id])throw"module `"+d._id+"` and module `"+i+"` make up a circular dependency relationship";d._deps[e]=i,R[d._id][i]=1,P.push({id:i,by:d._id}),R[i]||(R[i]={},T.test(n)?r(i):t(i))})),G===H&&!I.length&&b&&B[b]&&(p(P,function(e,n){if(!R[n.id])throw"can not found module `"+n.id+"`, but module `"+n.by+"` dependence on it"}),o(b),R=null,I=null,P=null)}function n(e){e.exports={},e._exec=function(){var n=function(n){n=n.replace(T,"");var o=e._isAnonymous?s(i(e._id),n):n;if(!B[o])throw"can not found module `"+o+"`, require in `"+e._id+"`";return B[o]._exec()};return function(){var o=e._id;return e._hasExport?B[o].exports:(e._factory.call(window,n,e.exports,e),e._hasExport=!0,B[o].exports=e.exports)}}()}function o(e){if(!B[e])throw"can not found module `"+e+"`";console.log("past "+(Date.now()-v)+" ms"),console.groupEnd("coolie modules"),B[e]._exec(),d(coolie.callback)&&coolie.callback(B[e].exports)}function t(n){var o,t,r=a(n),i=Date.now(),s=m(n);return G++,r?(o=document.createElement("script"),t=function(n){S.removeChild(o),"error"===n.type?console.groupEnd("coolie modules"):(console.log("script module",s,Date.now()-i+"ms"),H++,e(o))},o.id=n,o.async=!0,o.defer=!0,o.src=s,o.onload=o.onerror=t,void S.appendChild(o)):setTimeout(function(){console.log("local module",s,Date.now()-i+"ms"),H++,e()},1)}function r(n){G++;var o=new XMLHttpRequest,t=Date.now(),r=function(){if(200!==o.status&&304!==o.status)throw"can not ajax "+n+", response status is "+o.status;console.log("text module",n,Date.now()-t+"ms"),H++,e(o,n)};o.onload=o.onerror=o.onabort=o.ontimeout=r,o.open("GET",n),o.send(null)}function i(e){return e.replace(D,"/")}function a(e){return(e.replace(T,"").replace(C,"").match($)||[""])[0]}function s(e,n){var o=(e.match(C)||[""])[0],t=a(e),r=a(n),i=0,s=e.replace(C,""),c=n;switch(t||(s="./"+s),"/"!==s.slice(-1)&&(s+="/"),r||(c="./"+c,r="./"),r){case"./":return o+s+c.slice(2);case"../":for(i=c.match(A).length;i-->0;){if(!j.test(s))throw"can not change path from `"+e+"` to `"+n+"`";s=s.replace(j,"")}return o+s+c.replace(A,"");default:return o+c}}function c(e){var n=[];return e.replace(E,"").replace(x,function(e,o,t){t&&n.push(t)}),n}function u(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function l(e){return"array"===u(e)}function d(e){return"function"===u(e)}function f(e){return"string"===u(e)}function p(e,n){var o,t;if(l(e))for(o=0,t=e.length;t>o&&n(o,e[o])!==!1;o++);else if("object"==typeof e)for(o in e)if(e.hasOwnProperty(o)&&n(o,e[o])===!1)break}function m(e){var n,o,t,r=u(N.version);switch(r){case"string":return e+(e.indexOf("?")>-1?"&":"?")+"_="+encodeURIComponent(N.version);case"object":return n=e.replace(N.base,""),t=(e.match(k)||[""])[0],o=N.version[n]||N.version["./"+n],o?e.replace(k,"").replace(q,"."+o+"$1")+t:e;default:return e}}function h(){var e=document.getElementsByTagName("script");return e[e.length-1]}function w(e){return e.dataset?e.dataset.main:e.getAttribute("data-main")}var _,g,b,v,y="0.2.0",x=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,E=/\\\\/g,A=/\.\.\//g,D=/\/([^\/]+)$/,$=/^.*?\//,j=/[^\/]+\/$/,k=/\?.*$/,q=/(\.[^.]*)$/,C=/^.*\/\/[^\/]*/,T=/^(css|html|text)!/i,O=h(),S=O.parentNode,L=location.protocol+"//"+location.host+i(s(i(location.pathname),O.getAttribute("src"))),M=w(O),N={base:L},R={},B={},G=0,H=0,I=[],P=[];window.define=function(e,n,o){var t=arguments,r=1===t.length;if(b||(r?b=_:(g=b=e,R={},R[g]={})),r)o=t[0],e="";else{if(!f(e))throw new Error("module id must be a string");if(d(t[1])&&(o=t[1],n=[]),!l(n))throw new Error("module defineModules must be an array")}if(!d(o))throw new Error("module factory must be a function");n=r?c(o.toString()):n,I.push([e,n,o])},window.coolie={version:y,modules:B,callback:null,config:function(e){return e=e||{},N.base=e.base?s(L,e.base):L,N.version=e.version,this},use:function(e){if(_)throw new Error("can not  execute `coolie.use` twice more");if(!f(N.base))throw new Error("coolie config `base` property must be a string");if(e&&!f(e))throw new Error("main module must be a string");return M&&M!==e&&(e&&console.warn("attribute main is `"+M+"`, but use main is `"+e+"`"),e=M),_=s(N.base,e),v=Date.now(),console.group("coolie modules"),t(_),this}}}();