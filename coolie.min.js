/*!
 * coolie 苦力
 * @author ydr.me
 * @version 0.5.0
 * @license MIT
 */
!function(){"use strict";function e(e,o){var r,u,l,f={};2===arguments.length?(l=e,f._isAnonymous=!1,f._id=o,f._type="ajax",f._path=a(o),f._deps=[],f._factory=function(e,t,n){n.exports=l.responseText||"",l=null},t(f),z[f._id]=f,X[f._id]={}):K.length&&(u=e,r=K.shift(),f._isAnonymous=""===r[0],f._id=r[0]||u.id,f._type=r[0]?"local":"script",u=null,f._path=f._isAnonymous?a(f._id):"",f._deps=r[1],f._factory=r[2],t(f),z[f._id]=f,X[f._id]={},f._deps.length&&h(f._deps,function(e,t){var n=t.replace(N,""),o=f._isAnonymous?c(f._path,n):n;if(X[o]&&X[o][f._id])throw"module `"+f._id+"` and module `"+o+"` make up a circular dependency relationship";f._deps[e]=o,X[f._id][o]=1,Q.push({id:o,by:f._id}),X[o]||(X[o]={},N.test(t)?s(o):i(o))})),F===J&&!K.length&&x&&z[x]&&(h(Q,function(e,t){if(!X[t.id])throw"can not found module `"+t.id+"`, but module `"+t.by+"` dependence on it"}),n(x),X=null,K=null,Q=null)}function t(e){e.exports={},e._exec=function(){var t=function(t){var n=e._isAnonymous?c(a(e._id),o(t)):t;if(!z[n])throw"can not found module `"+n+"`, but required in `"+e._id+"`";return z[n]._exec()};return function(){var n=e._id;return e._hasExport?z[n].exports:(e._hasExport=!0,z[n].exports=e._factory.call(window,t,e.exports,e)||e.exports,z[n].exports)}}()}function n(e){if(!z[e])throw"can not found module `"+e+"`";console.log("past "+(Date.now()-E)+" ms"),console.groupEnd("coolie modules"),z[e]._exec(),p(coolie.callback)&&coolie.callback(z[e].exports)}function o(e){if(N.test(e))return e.replace(S,"").replace(N,"");if(e.indexOf("?")>-1)return e;var t=e.slice(-1);switch(t){case"#":return e.slice(0,-1);case"/":return e+"index.js";default:return R.test(e)?e:e+".js"}}function r(e,t,n){var o=document.createElement("script");o.id=n,o.src=e,o.async=!0,o.defer=!0,G.appendChild(o),o.onload=o.onerror=function(){G.removeChild(o),p(t)&&t.apply(this,arguments)}}function i(t){t=o(t);var n=u(t),i=Date.now(),s=_(t);return F++,n?void r(s,function(t){"error"===t.type?console.groupEnd("coolie modules"):(console.log("script module",s,Date.now()-i+"ms"),J++,e(this))},t):setTimeout(function(){console.log("local module",s,Date.now()-i+"ms"),J++,e()},1)}function s(t){F++;var n,o=new XMLHttpRequest,r=Date.now(),i=function(){if(4===o.readyState&&!n){if(n=!0,200!==o.status&&304!==o.status)throw"can not ajax "+t+", response status is "+o.status;console.log("text module",t,Date.now()-r+"ms"),J++,e(o,t)}};o.onload=o.onreadystatechange=o.onerror=o.onabort=o.ontimeout=i,o.open("GET",t),o.send(null)}function a(e){return e.replace(k,"/")}function u(e){var t;return M.test(e)?(t=e.match(M),t[1]||"//"):(e.replace(N,"").match(q)||[""])[0]}function c(e,t){var n=(e.match(M)||[""])[0],o=u(e),r=u(t),i=0,s=e.replace(M,""),a=t;if(M.test(r))return L.test(t)?t:location.protocol+t;switch(o||(s="./"+s),"/"!==s.slice(-1)&&(s+="/"),r||(a="./"+a,r="./"),r){case"./":return n+s+a.slice(2);case"../":for(i=a.match($).length;i-->0;){if(!C.test(s))throw"can not change path from `"+e+"` to `"+t+"`";s=s.replace(C,"")}return n+s+a.replace($,"");default:return n+a}}function l(e){var t=[];return e.replace(D,"").replace(A,function(e,n,o){o&&t.push(o)}),t}function f(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function d(e){return"array"===f(e)}function p(e){return"function"===f(e)}function m(e){return"string"===f(e)}function h(e,t){var n,o;if(d(e))for(n=0,o=e.length;o>n&&t(n,e[n])!==!1;n++);else if("object"==typeof e)for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}function _(e){var t,n,o,r=f(U.version);switch(r){case"string":return e+(e.indexOf("?")>-1?"&":"?")+"_="+encodeURIComponent(U.version);case"object":return t=e.replace(U.base,""),o=(e.match(O)||[""])[0],n=U.version[t]||U.version["./"+t],n?e.replace(O,"").replace(T,"."+n+"$1")+o:e;default:return e}}function g(){var e=document.getElementsByTagName("script");return e[e.length-1]}function w(e){return e.hasAttribute?e.src:e.getAttribute("src",4)}function b(e,t){return e.getAttribute("data-"+t)}var v,y,x,E,j="0.5.0",A=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,D=/\\\\/g,$=/\.\.\//g,k=/\/([^\/]+)$/,q=/^.*?\//,C=/[^\/]+\/$/,O=/\?.*$/,S=/[?#].*$/,T=/(\.[^.]*)$/,L=/^https?:/i,M=/^(.*)\/\/[^/]*/,N=/^(css|html|text)!/i,R=/\.js$/i,B=g(),G=B.parentNode,H=a(w(B)),I=b(B,"main"),P=b(B,"config"),U={base:H},X={},z={},F=0,J=0,K=[],Q=[];window.define=function(e,t,n){var o=arguments,r=1===o.length;if(x||(r?x=v:(y=x=e,X={},X[y]={})),r)n=o[0],e="";else{if(!m(e))throw"module id must be a string";if(p(o[1])&&(n=o[1],t=[]),!d(t))throw"module defineModules must be an array"}if(!p(n))throw"module factory must be a function";t=r?l(n.toString()):t,K.push([e,t,n])},window.coolie={version:j,modules:z,callback:null,config:function(e){return e=e||{},U.base=e.base?c(H,e.base):H,U.version=e.version,this},use:function(e){if(v)throw new Error("can not  execute `coolie.use` twice more");if(!m(U.base))throw new Error("coolie config `base` property must be a string");if(e&&!m(e))throw new Error("main module must be a string");return I&&I!==e&&(e&&console.warn("attribute main is `"+I+"`, but use main is `"+e+"`"),e=I),v=c(U.base,e),E=Date.now(),console.group("coolie modules"),i(v),this}},P&&r(c(H,P)+"?_="+Date.now())}();