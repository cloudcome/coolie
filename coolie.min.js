/*!
 * coolie 苦力
 * @author ydr.me
 * @version 0.5.0
 * @license MIT
 */
!function(){"use strict";function e(e,o){var r,s,l,d={};2===arguments.length?(l=e,d._isAnonymous=!1,d._id=o,d._type="ajax",d._path=u(o),d._deps=[],d._factory=function(e,t,n){n.exports=l.responseText||"",l=null},t(d),F[d._id]=d,z[d._id]={}):Q.length&&(s=e,r=Q.shift(),d._isAnonymous=""===r[0],d._id=r[0]||s.id,d._type=r[0]?"local":"script",s=null,d._path=d._isAnonymous?u(d._id):"",d._deps=r[1],d._factory=r[2],t(d),F[d._id]=d,z[d._id]={},d._deps.length&&h(d._deps,function(e,t){var n=t.replace(N,""),o=d._isAnonymous?c(d._path,n):n;if(z[o]&&z[o][d._id])throw"module `"+d._id+"` and module `"+o+"` make up a circular dependency relationship";d._deps[e]=o,z[d._id][o]=1,V.push({id:o,by:d._id}),z[o]||(z[o]={},N.test(t)?a(o):i(o))})),J===K&&!Q.length&&x&&F[x]&&(h(V,function(e,t){if(!z[t.id])throw"can not found module `"+t.id+"`, but module `"+t.by+"` dependence on it"}),n(x),z=null,Q=null,V=null)}function t(e){e.exports={},e._exec=function(){var t=function(t){var n=e._isAnonymous?c(u(e._id),o(t)):t;if(!F[n])throw"can not found module `"+n+"`, but required in `"+e._id+"`";return F[n]._exec()};return function(){var n=e._id;return e._hasExport?F[n].exports:(e._hasExport=!0,F[n].exports=e._factory.call(window,t,e.exports,e)||e.exports,F[n].exports)}}()}function n(e){if(!F[e])throw"can not found module `"+e+"`";W.log("past "+(Date.now()-E)+" ms"),W.groupEnd("coolie modules"),F[e]._exec(),p(coolie.callback)&&coolie.callback(F[e].exports)}function o(e){if(N.test(e))return e.replace(O,"").replace(N,"");if(e.indexOf("?")>-1)return e;var t=e.slice(-1);switch(t){case"#":return e.slice(0,-1);case"/":return e+"index.js";default:return R.test(e)?e:e+".js"}}function r(e,t,n){var o=document.createElement("script"),r=function(){H.removeChild(o),p(t)&&t.apply(this,arguments)};o.id=n,o.src=e,o.async=!0,o.defer=!0,H.appendChild(o),G?o.onload=r:o.onreadystatechange=function(){/loaded|complete/.test(o.readyState)&&r.call(this,arguments)},o.onerror=r}function i(t){t=o(t);var n=s(t),i=Date.now(),a=g(t);return J++,n?void r(a,function(t){"error"===t.type?W.groupEnd("coolie modules"):(W.log("script module",a,Date.now()-i+"ms"),K++,e(this))},t):setTimeout(function(){W.log("local module",a,Date.now()-i+"ms"),K++,e()},1)}function a(t){J++;var n,o=new XMLHttpRequest,r=Date.now(),i=function(){if(4===o.readyState&&!n){if(n=!0,200!==o.status&&304!==o.status)throw"can not ajax "+t+", response status is "+o.status;W.log("text module",t,Date.now()-r+"ms"),K++,e(o,t)}};o.onload=o.onreadystatechange=o.onerror=o.onabort=o.ontimeout=i,o.open("GET",t),o.send(null)}function u(e){return e.replace(k,"/")}function s(e){var t;return M.test(e)?(t=e.match(M),t[1]||"//"):(e.replace(N,"").match(S)||[""])[0]}function c(e,t){var n=(e.match(M)||[""])[0],o=s(e),r=s(t),i=0,a=e.replace(M,""),u=t;if(M.test(r))return L.test(t)?t:location.protocol+t;switch(o||(a="./"+a),"/"!==a.slice(-1)&&(a+="/"),r||(u="./"+u,r="./"),r){case"./":return n+a+u.slice(2);case"../":for(i=u.match($).length;i-->0;){if(!q.test(a))throw"can not change path from `"+e+"` to `"+t+"`";a=a.replace(q,"")}return n+a+u.replace($,"");default:return n+u}}function l(e){var t=[];return e.replace(D,"").replace(A,function(e,n,o){o&&t.push(o)}),t}function d(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function f(e){return"array"===d(e)}function p(e){return"function"===d(e)}function m(e){return"string"===d(e)}function h(e,t){var n,o;if(f(e))for(n=0,o=e.length;o>n&&t(n,e[n])!==!1;n++);else if("object"==typeof e)for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}function g(e){var t,n,o,r=d(X.version);switch(r){case"string":return e+(e.indexOf("?")>-1?"&":"?")+"_="+encodeURIComponent(X.version);case"object":return t=e.replace(X.base,""),o=(e.match(C)||[""])[0],n=X.version[t]||X.version["./"+t],n?e.replace(C,"").replace(T,"."+n+"$1")+o:e;default:return e}}function w(){var e=document.getElementsByTagName("script");return e[e.length-1]}function _(e){return e.hasAttribute?e.src:e.getAttribute("src",4)}function b(e,t){return e.getAttribute("data-"+t)}var y,v,x,E,j="0.5.0",A=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,D=/\\\\/g,$=/\.\.\//g,k=/\/([^\/]+)$/,S=/^.*?\//,q=/[^\/]+\/$/,C=/\?.*$/,O=/[?#].*$/,T=/(\.[^.]*)$/,L=/^https?:/i,M=/^(.*)\/\/[^/]*/,N=/^(css|html|text)!/i,R=/\.js$/i,B=w(),G="onload"in B,H=B.parentNode,I=u(_(B)),P=b(B,"main"),U=b(B,"config"),X={base:I},z={},F={},J=0,K=0,Q=[],V=[],W=function(){var e={},t=window.console,n=["log","warn","group","groupEnd"];return h(n,function(n,o){e[o]=function(){if(t&&t[o])try{t[o].apply(t,arguments)}catch(e){}}}),e}();window.define=function(e,t,n){var o=arguments,r=1===o.length;if(x||(r?x=y:(v=x=e,z={},z[v]={})),r)n=o[0],e="";else{if(!m(e))throw"module id must be a string";if(p(o[1])&&(n=o[1],t=[]),!f(t))throw"module defineModules must be an array"}if(!p(n))throw"module factory must be a function";t=r?l(n.toString()):t,Q.push([e,t,n])},window.coolie={version:j,modules:F,callback:null,config:function(e){return e=e||{},X.base=e.base?c(I,e.base):I,X.version=e.version,this},use:function(e){if(y)throw new Error("can not  execute `coolie.use` twice more");if(!m(X.base))throw new Error("coolie config `base` property must be a string");if(e&&!m(e))throw new Error("main module must be a string");return P&&P!==e&&(e&&W.warn("attribute main is `"+P+"`, but use main is `"+e+"`"),e=P),y=c(X.base,e),E=Date.now(),W.group("coolie modules"),i(y),this}},U&&r(c(I,U)+"?_="+Date.now())}();