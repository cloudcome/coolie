/*!
 * coolie 苦力
 * @author ydr.me
 * @version 0.5.0
 * @license MIT
 */
!function(){"use strict";function e(e,o){var c,a,l,d={};2===arguments.length?(l=e,d._isAnonymous=!1,d._id=o,d._type="ajax",d._path=s(o),d._deps=[],d._factory=function(e,n,t){t.exports=l.responseText||"",l=null},n(d),U[d._id]=d,P[d._id]={}):F.length&&(a=e,c=F.shift(),d._isAnonymous=""===c[0],d._id=c[0]||a.id,d._type=c[0]?"local":"script",a=null,d._path=d._isAnonymous?s(d._id):"",d._deps=c[1],d._factory=c[2],n(d),U[d._id]=d,P[d._id]={},d._deps.length&&m(d._deps,function(e,n){var t=n.replace(L,""),o=d._isAnonymous?u(d._path,t):t;if(P[o]&&P[o][d._id])throw"module `"+d._id+"` and module `"+o+"` make up a circular dependency relationship";d._deps[e]=o,P[d._id][o]=1,J.push({id:o,by:d._id}),P[o]||(P[o]={},L.test(n)?i(o):r(o))})),X===z&&!F.length&&y&&U[y]&&(m(J,function(e,n){if(!P[n.id])throw"can not found module `"+n.id+"`, but module `"+n.by+"` dependence on it"}),t(y),P=null,F=null,J=null)}function n(e){e.exports={},e._exec=function(){var n=function(n){var t=e._isAnonymous?u(s(e._id),o(n)):n;if(!U[t])throw"can not found module `"+t+"`, require in `"+e._id+"`";return U[t]._exec()};return function(){var t=e._id;return e._hasExport?U[t].exports:(e._hasExport=!0,U[t].exports=e._factory.call(window,n,e.exports,e)||e.exports,U[t].exports)}}()}function t(e){if(!U[e])throw"can not found module `"+e+"`";console.log("past "+(Date.now()-x)+" ms"),console.groupEnd("coolie modules"),U[e]._exec(),f(coolie.callback)&&coolie.callback(U[e].exports)}function o(e){if(L.test(e))return e.replace(O,"").replace(L,"");if(e.indexOf("?")>-1)return e;var n=e.slice(-1);switch(n){case"#":return e.slice(0,-1);case"/":return e+"index.js";default:return M.test(e)?e:e+".js"}}function r(n){n=o(n);var t,r,i=c(n),s=Date.now(),u=h(n);return X++,i?(t=document.createElement("script"),r=function(n){R.removeChild(t),"error"===n.type?console.groupEnd("coolie modules"):(console.log("script module",u,Date.now()-s+"ms"),z++,e(t))},t.id=n,t.async=!0,t.defer=!0,t.src=u,t.onload=t.onerror=r,void R.appendChild(t)):setTimeout(function(){console.log("local module",u,Date.now()-s+"ms"),z++,e()},1)}function i(n){X++;var t=new XMLHttpRequest,o=Date.now(),r=function(){if(200!==t.status&&304!==t.status)throw"can not ajax "+n+", response status is "+t.status;console.log("text module",n,Date.now()-o+"ms"),z++,e(t,n)};t.onload=t.onerror=t.onabort=t.ontimeout=r,t.open("GET",n),t.send(null)}function s(e){return e.replace($,"/")}function c(e){return(e.replace(L,"").replace(S,"").match(k)||[""])[0]}function u(e,n){var t=(e.match(S)||[""])[0],o=c(e),r=c(n),i=0,s=e.replace(S,""),u=n;switch(o||(s="./"+s),"/"!==s.slice(-1)&&(s+="/"),r||(u="./"+u,r="./"),r){case"./":return t+s+u.slice(2);case"../":for(i=u.match(D).length;i-->0;){if(!C.test(s))throw"can not change path from `"+e+"` to `"+n+"`";s=s.replace(C,"")}return t+s+u.replace(D,"");default:return t+u}}function a(e){var n=[];return e.replace(A,"").replace(j,function(e,t,o){o&&n.push(o)}),n}function l(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function d(e){return"array"===l(e)}function f(e){return"function"===l(e)}function p(e){return"string"===l(e)}function m(e,n){var t,o;if(d(e))for(t=0,o=e.length;o>t&&n(t,e[t])!==!1;t++);else if("object"==typeof e)for(t in e)if(e.hasOwnProperty(t)&&n(t,e[t])===!1)break}function h(e){var n,t,o,r=l(I.version);switch(r){case"string":return e+(e.indexOf("?")>-1?"&":"?")+"_="+encodeURIComponent(I.version);case"object":return n=e.replace(I.base,""),o=(e.match(q)||[""])[0],t=I.version[n]||I.version["./"+n],t?e.replace(q,"").replace(T,"."+t+"$1")+o:e;default:return e}}function _(){var e=document.getElementsByTagName("script");return e[e.length-1]}function g(e){return e.hasAttribute?e.src:e.getAttribute("src",4)}function w(e,n){return e.getAttribute("data-"+n)}var b,v,y,x,E="0.5.0",j=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,A=/\\\\/g,D=/\.\.\//g,$=/\/([^\/]+)$/,k=/^.*?\//,C=/[^\/]+\/$/,q=/\?.*$/,O=/[?#].*$/,T=/(\.[^.]*)$/,S=/^.*\/\/[^\/]*/,L=/^(css|html|text)!/i,M=/\.js$/i,N=_(),R=N.parentNode,B=s(g(N)),G=w(N,"main"),H=w(N,"config"),I={base:B},P={},U={},X=0,z=0,F=[],J=[];window.define=function(e,n,t){var o=arguments,r=1===o.length;if(y||(r?y=b:(v=y=e,P={},P[v]={})),r)t=o[0],e="";else{if(!p(e))throw"module id must be a string";if(f(o[1])&&(t=o[1],n=[]),!d(n))throw"module defineModules must be an array"}if(!f(t))throw"module factory must be a function";n=r?a(t.toString()):n,F.push([e,n,t])},window.coolie={version:E,modules:U,callback:null,config:function(e){return e=e||{},I.base=e.base?u(B,e.base):B,I.version=e.version,this},use:function(e){if(b)throw new Error("can not  execute `coolie.use` twice more");if(!p(I.base))throw new Error("coolie config `base` property must be a string");if(e&&!p(e))throw new Error("main module must be a string");return G&&G!==e&&(e&&console.warn("attribute main is `"+G+"`, but use main is `"+e+"`"),e=G),b=u(I.base,e),x=Date.now(),console.group("coolie modules"),r(b),this}},function(){if(H){var e=document.createElement("script"),n=u(B,H);e.src=n+"?_="+Date.now(),R.appendChild(e),console.log("load config",n)}}()}();